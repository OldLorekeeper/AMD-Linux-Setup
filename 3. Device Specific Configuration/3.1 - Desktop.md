## 3.1.1 - Additional packages

```
yay -S jellyfin-web jellyfin-server lutris prowlarr-bin radarr-bin solaar solidity-bin sonarr-bin lidarr-bin slskd-bin
```

Enable services:

```
sudo systemctl enable --now sonarr radarr lidarr prowlarr jellyfin
```

Provide sonarr with necessary udev rules:

```
sudo wget -O /etc/udev/rules.d/42-solaar-uinput.rules https://raw.githubusercontent.com/pwr-Solaar/Solaar/master/rules.d-uinput/42-solaar-uinput.rules
```

```
sudo udevadm control --reload-rules && sudo udevadm trigger
```
journalctl -u soularr.service -f
<br/>
 
## 3.1.2 - Install sunshine

```
kate **/etc/pacman.conf**
```

Add following to bottom of file:

```
[lizardbyte]
SigLevel = Optional
Server = https://github.com/LizardByte/pacman-repo/releases/latest/download
```

Install with pacman:

```
sudo pacman -S sunshine
```

Enable Wayland/Sunshine screen share:

```
sudo setcap cap_sys_admin+p $(readlink -f $(which sunshine))
```

Enable service:

```
systemctl --user enable --now sunshine
```

Edit application commands to change resolutions:

```
>> Kscreen-doctor -o
>> Review output and determine which numbered ‘mode’ corresponds to which resolution
>> Select application (i.e. Desktop / Steam Big Picture)
>> Add command
>> Do command: kscreen-doctor output.DP-1.mode.[number]
>> Undo command: kscreen-doctor output.DP-1.mode.[number]
```

<br/>
 
## 3.1.3 - Overclock GPU

https://github.com/ilya-zlobintsev/LACT

```
>> Watt: 300  
>> Performance level: Manual  
>> Power level mode: 3D_FULL_SCREEN  
>> Max GPU clock: 2900  
>> Max VRAM: 2600  
>> Voltage offset: 0**
```

<br/>
 
## 3.1.4 - Mount media drive

```
kate /etc/fstab
```

```
# /dev/nvme0n1p1
UUID=a52c191f-74b1-491d-9513-4b2e92c6f151 	/mnt/Media 	auto 	nosuid,nodev,nofail,x-gvfs-hide 	0 0
```

<br/>
 
## 3.1.5 - Replace sunshine tray icons following update

Create executable script:

```
sudo tee /usr/local/bin/replace-sunshine-icons.sh > /dev/null << 'EOF'
#!/bin/bash

DEST_DIR="/usr/share/icons/hicolor/scalable/status"
BASE_URL="https://raw.githubusercontent.com/OldLorekeeper/AMD-Linux-Setup/main/5.%20Resources/Icons/Sunshine%20Tray%20Icons"
ICONS=("sunshine-locked.svg" "sunshine-pausing.svg" "sunshine-playing.svg" "sunshine-tray.svg")

for icon in "\${ICONS[@]}"; do
    ICON_URL="\$BASE_URL/\$icon"
    TEMP_ICON="/tmp/\$icon"

    # Download the latest version from the GitHub raw content
    curl -s -L -o "\$TEMP_ICON" "\$ICON_URL"

    # If the download is successful, replace the system icon
    if [[ -f "\$TEMP_ICON" ]]; then
        sudo cp "\$TEMP_ICON" "\$DEST_DIR/\$icon"
        rm "\$TEMP_ICON"  # Clean up the temp file
    fi
done
EOF

sudo chmod +x /usr/local/bin/replace-sunshine-icons.sh
```

Create pacman hook:

```
sudo tee /etc/pacman.d/hooks/sunshine-icons.hook > /dev/null << 'EOF'
[Trigger]
Operation = Install
Operation = Upgrade
Type = Package
Target = sunshine

[Action]
Description = Replacing Sunshine tray icons...
When = PostTransaction
Exec = /usr/local/bin/replace-sunshine-icons.sh
EOF
```

<br/>

## 3.1.6 - Jellyfin HideMe tag automation

This sets up a background service that automatically hides any Jellyfin items tagged with `hideme` by marking them as fully played. This removes them from the _Continue Watching_ feed without deleting anything.

Create script:

```
kedit ~/Make/hideme_tag.py
```

Paste the script (replace API and USERNAME placeholders):

```
#!/usr/bin/env python3
import requests

JELLYFIN_URL = "http://localhost:8096"
API_KEY = "INSERT-API"
USERNAME = "INSERT-USERNAME"
HIDE_TAG = "hideme"

headers = {
    "X-Emby-Token": API_KEY
}

# Get user ID from name
users_resp = requests.get(f"{JELLYFIN_URL}/Users", headers=headers)
users_resp.raise_for_status()
users = users_resp.json()
user = next(u for u in users if u["Name"] == USERNAME)
user_id = user["Id"]

# Find tagged items
resp = requests.get(f"{JELLYFIN_URL}/Users/{user_id}/Items", params={
    "Recursive": "true",
    "IncludeItemTypes": "Episode,Movie",
    "Tags": HIDE_TAG
}, headers=headers)
resp.raise_for_status()
items = resp.json()["Items"]

# Mark as played and simulate full playback
for item in items:
    item_id = item["Id"]
    name = item["Name"]
    runtime = item.get("RunTimeTicks")

    if not runtime:
        print(f"Skipping {name} (no duration info)")
        continue

    print(f"Marking as played: {name}")

    requests.post(f"{JELLYFIN_URL}/Users/{user_id}/PlayedItems/{item_id}", headers=headers)
    requests.post(f"{JELLYFIN_URL}/Sessions/Playing/Stopped", headers=headers, json={
        "ItemId": item_id,
        "PositionTicks": runtime - 1,
        "PlaySessionId": "",
        "CanSeek": True
    })
```

Make script executable:

```
chmod +x ~/Make/hideme_tag.py
```

Create service:

```
mkdir -p ~/.config/systemd/user
nano ~/.config/systemd/user/hideme_tag.service
```

```
[Unit]
Description=Run Jellyfin HideMe cleanup
After=network.target

[Service]
Type=oneshot
ExecStart=/home/curtis/Make/hideme_tag.py
```

Create timer:

```
nano ~/.config/systemd/user/hideme_tag.timer
```

```
[Unit]
Description=Run HideMe script every 10 minutes

[Timer]
OnBootSec=1min
OnUnitActiveSec=10min
Persistent=true

[Install]
WantedBy=default.target
```

Enable and start:

```
systemctl --user daemon-reload
systemctl --user enable --now hideme_tag.timer
```

Check timer:

```
systemctl --user list-timers
journalctl --user -u hideme_tag.service
```

<br/>

## 3.1.7 - Setup lidarr, slskd and soularr

Edit slskd systemd service:

```
sudo systemctl edit slskd
```

Paste following between three hash zone ###

```
[Service]  
ExecStart=  
ExecStart=/usr/lib/slskd/slskd --config /etc/slskd/slskd.yml
```

Make slskd config directory and file:

```
sudo mkdir -p /etc/slskd
kate /etc/slskd/slskd.yml
```

Copy following into slskd.yml - edit usernames and passwords:

```
web:
  port: 5030
  https:
    disabled: true
  authentication:
    disabled: false
    username: [insert webui username]
    password: [insert webui password]
    api_keys:
       my_api_key:
         key: edf07c6dee0dc36986eff33d2ba56093
         role: administrator
         cidr: 127.0.0.1/32,::1/128
directories:
  downloads: /mnt/Media/Torrents/slskd/Complete
  incomplete: /mnt/Media/Torrents/slskd/Incomplete
soulseek:
  username: [insert desired soluseek username]
  password: [insert desired soluseek password - no symbols]
```

Start service:

```
sudo systemctl daemon-reload
sudo systemctl enable --now slskd.service
```

Navigate to slskd and login:

```
http://localhost:5030/
```

Add slskd as download client to Lidarr:

```
>> Add remote path mapping
>> Host: localhost
>> Remote Path: /mnt/Media/Torrents/slskd/Complete
>> Local Path: /mnt/Media/Torrents/slskd/Complete/
```

Install soularr:

```
cd /opt
sudo git clone https://github.com/mrusse/soularr.git
sudo chown -R youruser:yourgroup soularr
cd soularr
```

Install Python toolchain:

```
sudo pacman -Syu python python-pip python-setuptools python-wheel python-schedule python-requests python-pydantic python-dotenv
```

Install Soularr requirements system-wide:

```
sudo pip install --break-system-packages -r /opt/soularr/requirements.txt   
```

Edit config.ini:

```
kate /opt/soularr/config.ini
```

Paste following over Lidarr and Slskd sections of soularr config.ini:

```
[Lidarr]
api_key = [insert Lidarr API: Settings > General > API Key]
host_url = http://localhost:8686
download_dir = /mnt/Media/Torrents/slskd/Complete
disable_sync = False

[Slskd]
api_key = edf07c6dee0dc36986eff33d2ba56093
host_url = http://localhost:5030
url_base = /
download_dir = /mnt/Media/Torrents/slskd/Complete
delete_searches = False
stalled_timeout = 3600
```

Test soularr:

```
cd /opt/soularr
/usr/bin/python soularr.py
```

Create Soularr service:

```
kate /etc/systemd/system/soularr.service
```

Paste following into service file:

```
[Unit]
Description=Soularr (Lidarr ↔ Slskd automation)
Wants=network-online.target lidarr.service slskd.service
After=network-online.target lidarr.service slskd.service
Requires=lidarr.service slskd.service
# Optional sanity checks (uncomment and adjust if you want hard failures):
# ConditionPathExists=/opt/soularr/config.ini
# ConditionPathExists=/mnt/Media/Torrents/slskd/Complete/

[Service]
Type=oneshot
User=curtis
Group=curtis
WorkingDirectory=/opt/soularr
# Use --no-lock-file to prevent leftover .soularr.lock issues
# Adjust the config-dir path if you keep config.ini elsewhere
ExecStart=/usr/bin/python /opt/soularr/soularr.py --config-dir /opt/soularr --no-lock-file
# Hardening (keep, but allow writes where Soularr actually writes)
NoNewPrivileges=yes
PrivateTmp=yes
ProtectSystem=full
ProtectHome=read-only
# Soularr writes a lock file in WorkingDirectory and needs to move files in downloads dir
ReadWritePaths=/opt/soularr /var/log /mnt/Media/Torrents/slskd/Complete/

```

Create timer:

```
kate /etc/systemd/system/soularr.timer
```

Paste following into timer file:

```
[Unit]
Description=Run Soularr every 5 minutes

[Timer]
OnCalendar=*:0/5
Persistent=true
AccuracySec=1min

[Install]
WantedBy=timers.target
```

Run service and timer:

```
sudo systemctl daemon-reload
sudo systemctl enable --now soularr.timer
```

Run following command to see verbose log for soularr service:

```
sudo journalctl -u soularr.service -f
```

Stay stable:

```
>>>Frezee requirments:
	pip freeze > /opt/soularr/requirements.lock
>>> When Soularr breaks, run:
	sudo pip install --break-system-packages -r /opt/soularr/requirements.lock
>>> Optional quick check:
	cat >/usr/local/bin/check-soularr-deps <<'SH'
	#!/bin/sh
	python - <<'PY'
	import requests, pydantic, schedule
	print("Soularr deps OK")
	PY
	SH
	sudo chmod +x /usr/local/bin/check-soularr-deps
	/usr/local/bin/check-soularr-deps
```

<br/>
 
### [Next ⇢](../4.%20KDE%20Settings/4.1%20-%20Window%20Rules.md)
